# CS32 - Chiness clone of STM32F103

Here are some notes on how to deal with these MCUs. If you got such a chip then I suppose you have bought BluePill on Aliexpress where some unfair sellers don't claim clearly enougth that the boards are based on a clone of STM32 MCUs.

You can debug these chips with OpenOCD. To do it you have to change idcode of the device in OpenOCD configuration. Original STM32F103 chip has `0x1ba01477`, but CS32 has `0x2ba01477`. So the simplest way is to find configuration file `stm32f1x.cfg` in OpenOCD directory and relpace idcode:

```
#set _CPUTAPID 0x1ba01477
set _CPUTAPID 0x2ba01477
```

Or create a new config for that case and replace a value. Also you should set reset mode to Software system reset. In STM32CubeIDE open `[project_name]Debug.cfg` and set reset configuration as:

```
reset_config none
set CONNECT_UNDER_RESET 0
set CORE_RESET 0
```

Now debugging should work.

stlink gdbserver that is shipped with TrueStudio or STMCubeIDE doesn't work with these chips. When it tries to connect, there is an error in output stating that it can not verify the device. I suppose the problem is the same as with OpenOCD because of another idcode and maybe vendor. I think it is possible to make it work by modifying stlink utility [sources](https://github.com/stlink-org/stlink) and rebuilding it.
